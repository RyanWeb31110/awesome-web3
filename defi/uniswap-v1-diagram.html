<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uniswap V1 核心机制</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        
        h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        
        h3 {
            color: #34495e;
            margin: 20px 0 15px 0;
        }
        
        /* 对比图表 */
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 20px 0;
        }
        
        .comparison-box {
            padding: 20px;
            border-radius: 15px;
            position: relative;
            transition: transform 0.3s;
        }
        
        .comparison-box:hover {
            transform: translateY(-5px);
        }
        
        .traditional {
            background: linear-gradient(135deg, #ff6b6b, #ffa500);
            color: white;
        }
        
        .uniswap {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        /* 流动性池动画 */
        .pool-container {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
        }
        
        .pool {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 30px 0;
        }
        
        .token-pool {
            width: 180px;
            height: 200px;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: all 0.5s;
        }
        
        .eth-pool {
            background: linear-gradient(135deg, #627EEA, #4158D0);
            color: white;
        }
        
        .token-pool {
            background: linear-gradient(135deg, #FF6B6B, #FF8E53);
            color: white;
        }
        
        .pool-amount {
            font-size: 36px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .pool-label {
            font-size: 18px;
            opacity: 0.9;
        }
        
        .exchange-arrow {
            font-size: 48px;
            color: #667eea;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        
        /* AMM 公式展示 */
        .formula-box {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
            font-size: 24px;
            font-weight: bold;
            letter-spacing: 2px;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        
        /* 交易流程 */
        .trade-flow {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
        }
        
        .trade-step {
            flex: 1;
            text-align: center;
            padding: 20px;
            background: white;
            border-radius: 10px;
            margin: 0 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        
        .trade-step:hover {
            transform: translateY(-5px);
        }
        
        .step-number {
            width: 40px;
            height: 40px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-weight: bold;
        }
        
        /* 价格影响模拟器 */
        .simulator {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
        }
        
        .input-group {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            align-items: center;
        }
        
        input {
            padding: 12px;
            border: 2px solid #667eea;
            border-radius: 8px;
            font-size: 16px;
            width: 150px;
        }
        
        button {
            padding: 12px 25px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        button:hover {
            transform: scale(1.05);
        }
        
        .result-box {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid #667eea;
        }
        
        /* 流动性提供者收益 */
        .lp-benefits {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 20px 0;
        }
        
        .benefit-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s;
        }
        
        .benefit-card:hover {
            transform: translateY(-5px) scale(1.05);
        }
        
        .benefit-value {
            font-size: 32px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .benefit-label {
            opacity: 0.9;
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            .comparison {
                grid-template-columns: 1fr;
            }
            
            .pool {
                flex-direction: column;
            }
            
            .trade-flow {
                flex-direction: column;
            }
            
            .lp-benefits {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 标题部分 -->
        <div class="section">
            <h1 style="text-align: center; color: #667eea; font-size: 36px; margin-bottom: 10px;">
                Uniswap V1 核心机制
            </h1>
            <p style="text-align: center; color: #7f8c8d; font-size: 18px;">
                2018年11月 - 去中心化交易的开端
            </p>
        </div>
        
        <!-- 中心化 vs 去中心化对比 -->
        <div class="section">
            <h2>📊 交易模式对比</h2>
            <div class="comparison">
                <div class="comparison-box traditional">
                    <h3>🏦 传统中心化交易所</h3>
                    <ul style="margin-top: 15px; padding-left: 20px;">
                        <li>需要KYC认证</li>
                        <li>高额手续费（0.1%-0.5%）</li>
                        <li>上币费用昂贵</li>
                        <li>订单簿匹配</li>
                        <li>资金托管风险</li>
                        <li>可能被黑客攻击</li>
                    </ul>
                </div>
                <div class="comparison-box uniswap">
                    <h3>🦄 Uniswap V1</h3>
                    <ul style="margin-top: 15px; padding-left: 20px;">
                        <li>无需许可和KYC</li>
                        <li>固定0.3%手续费</li>
                        <li>免费创建交易对</li>
                        <li>自动做市商（AMM）</li>
                        <li>非托管（资金在智能合约中）</li>
                        <li>代码开源透明</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- 恒定乘积公式 -->
        <div class="section">
            <h2>🔢 恒定乘积公式（核心原理）</h2>
            <div class="formula-box">
                x × y = k
            </div>
            <p style="text-align: center; margin-top: 20px; color: #7f8c8d;">
                x = ETH数量 | y = ERC20代币数量 | k = 恒定值
            </p>
            
            <div class="pool-container">
                <h3>流动性池示例</h3>
                <div class="pool">
                    <div class="token-pool eth-pool">
                        <div class="pool-label">ETH池</div>
                        <div class="pool-amount" id="ethAmount">10</div>
                        <div class="pool-label">ETH</div>
                    </div>
                    <div class="exchange-arrow">⇄</div>
                    <div class="token-pool">
                        <div class="pool-label">DAI池</div>
                        <div class="pool-amount" id="daiAmount">10,000</div>
                        <div class="pool-label">DAI</div>
                    </div>
                </div>
                <p style="text-align: center; font-size: 18px; color: #667eea;">
                    k = 10 × 10,000 = 100,000（恒定）
                </p>
                <p style="text-align: center; margin-top: 10px; color: #7f8c8d;">
                    当前价格：1 ETH = 1,000 DAI
                </p>
            </div>
        </div>
        
        <!-- 交易流程 -->
        <div class="section">
            <h2>🔄 V1 交易流程（仅支持 ETH ⇄ ERC20）</h2>
            <div class="trade-flow">
                <div class="trade-step">
                    <div class="step-number">1</div>
                    <strong>用户发起交易</strong>
                    <p style="margin-top: 10px; color: #7f8c8d;">
                        输入ETH或ERC20代币
                    </p>
                </div>
                <div class="trade-step">
                    <div class="step-number">2</div>
                    <strong>智能合约计算</strong>
                    <p style="margin-top: 10px; color: #7f8c8d;">
                        基于x×y=k计算输出
                    </p>
                </div>
                <div class="trade-step">
                    <div class="step-number">3</div>
                    <strong>更新池子状态</strong>
                    <p style="margin-top: 10px; color: #7f8c8d;">
                        调整代币比例和价格
                    </p>
                </div>
                <div class="trade-step">
                    <div class="step-number">4</div>
                    <strong>完成交换</strong>
                    <p style="margin-top: 10px; color: #7f8c8d;">
                        用户收到目标代币
                    </p>
                </div>
            </div>
        </div>
        
        <!-- 价格影响计算器 -->
        <div class="section">
            <h2>💹 价格影响模拟器</h2>
            <div class="simulator">
                <p style="margin-bottom: 15px;">模拟在 10 ETH / 10,000 DAI 池中交易的价格影响：</p>
                <div class="input-group">
                    <label>购买ETH数量：</label>
                    <input type="number" id="tradeAmount" value="1" min="0.1" max="5" step="0.1">
                    <button onclick="calculateImpact()">计算影响</button>
                </div>
                <div class="result-box" id="result">
                    <p><strong>交易前：</strong> 1 ETH = 1,000 DAI</p>
                    <p><strong>需要支付：</strong> <span id="cost">-</span> DAI</p>
                    <p><strong>交易后价格：</strong> <span id="newPrice">-</span> DAI</p>
                    <p><strong>价格滑点：</strong> <span id="slippage">-</span>%</p>
                </div>
            </div>
        </div>
        
        <!-- 流动性提供者收益 -->
        <div class="section">
            <h2>💰 流动性提供者（LP）收益模型</h2>
            <div class="lp-benefits">
                <div class="benefit-card">
                    <div class="benefit-label">交易手续费</div>
                    <div class="benefit-value">0.3%</div>
                    <div class="benefit-label">每笔交易</div>
                </div>
                <div class="benefit-card">
                    <div class="benefit-label">假设日交易量</div>
                    <div class="benefit-value">$1M</div>
                    <div class="benefit-label">你的份额10%</div>
                </div>
                <div class="benefit-card">
                    <div class="benefit-label">日收益</div>
                    <div class="benefit-value">$300</div>
                    <div class="benefit-label">年化36.5%</div>
                </div>
            </div>
            <p style="text-align: center; color: #e74c3c; margin-top: 20px;">
                ⚠️ 注意：需要考虑无常损失风险
            </p>
        </div>
        
        <!-- V1 限制 -->
        <div class="section">
            <h2>⚠️ Uniswap V1 的限制</h2>
            <div style="background: #fff3cd; padding: 20px; border-radius: 10px; border-left: 4px solid #ffc107;">
                <ul style="padding-left: 20px; line-height: 2;">
                    <li><strong>仅支持 ETH ⇄ ERC20 交易对：</strong> 不能直接进行 DAI ⇄ USDC 交易</li>
                    <li><strong>需要双跳交易：</strong> ERC20 ⇄ ERC20 需要先换成ETH（双倍手续费）</li>
                    <li><strong>无价格预言机：</strong> 容易被闪电贷攻击操纵价格</li>
                    <li><strong>资本效率低：</strong> 流动性分散在整个价格曲线上</li>
                    <li><strong>无协议费用开关：</strong> 协议无法获得收入用于发展</li>
                </ul>
            </div>
        </div>
        
        <!-- 历史意义 -->
        <div class="section">
            <h2>🌟 V1 的历史意义</h2>
            <div style="background: linear-gradient(135deg, #667eea20, #764ba220); padding: 25px; border-radius: 15px;">
                <p style="font-size: 18px; line-height: 1.8;">
                    尽管有诸多限制，Uniswap V1 作为首个成功的 AMM DEX，证明了：
                </p>
                <ul style="margin-top: 15px; padding-left: 30px; line-height: 2;">
                    <li>✅ 无需订单簿的交易是可行的</li>
                    <li>✅ 恒定乘积公式可以有效定价</li>
                    <li>✅ 任何人都可以成为做市商</li>
                    <li>✅ 智能合约可以安全管理数百万美元</li>
                    <li>✅ DeFi 的未来是去中心化和无需许可的</li>
                </ul>
            </div>
        </div>
    </div>
    
    <script>
        function calculateImpact() {
            const buyAmount = parseFloat(document.getElementById('tradeAmount').value);
            
            // 初始池状态
            const initETH = 10;
            const initDAI = 10000;
            const k = initETH * initDAI;
            
            // 计算交易后状态
            const newETH = initETH - buyAmount;
            const newDAI = k / newETH;
            const daiNeeded = newDAI - initDAI;
            
            // 计算价格
            const oldPrice = initDAI / initETH;
            const newPrice = newDAI / newETH;
            const slippage = ((newPrice - oldPrice) / oldPrice * 100);
            
            // 更新显示
            document.getElementById('cost').textContent = daiNeeded.toFixed(2);
            document.getElementById('newPrice').textContent = newPrice.toFixed(2);
            document.getElementById('slippage').textContent = slippage.toFixed(2);
            
            // 更新池子显示
            document.getElementById('ethAmount').textContent = newETH.toFixed(2);
            document.getElementById('daiAmount').textContent = newDAI.toFixed(0);
        }
        
        // 初始计算
        calculateImpact();
    </script>
</body>
</html>